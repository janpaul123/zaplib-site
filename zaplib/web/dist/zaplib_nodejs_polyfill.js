!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.zaplib=t():e.zaplib=t()}(global,(function(){return(()=>{var __webpack_modules__={202:(module,__unused_webpack_exports,__webpack_require__)=>{const URL=__webpack_require__(310),VM=__webpack_require__(144),threads=__webpack_require__(267),WORKER=Symbol.for("worker"),EVENTS=Symbol.for("events");class EventTarget{constructor(){Object.defineProperty(this,EVENTS,{value:new Map})}dispatchEvent(e){if(e.target=e.currentTarget=this,this["on"+e.type])try{this["on"+e.type](e)}catch(e){console.error(e)}const t=this[EVENTS].get(e.type);null!=t&&t.forEach((t=>{try{t.call(this,e)}catch(e){console.error(e)}}))}addEventListener(e,t){let r=this[EVENTS].get(e);r||this[EVENTS].set(e,r=[]),r.push(t)}removeEventListener(e,t){let r=this[EVENTS].get(e);if(r){const e=r.indexOf(t);-1!==e&&r.splice(e,1)}}}function Event(e,t){this.type=e,this.timeStamp=Date.now(),this.target=this.currentTarget=this.data=null}module.exports=threads.isMainThread?mainThread():workerThread();const baseUrl=URL.pathToFileURL(process.cwd()+"/");function mainThread(){class e extends EventTarget{constructor(e,t){if(void 0===e)throw new Error("Creating worker with undefined url");super();const{name:r,type:o}=t||{};let a;a=/^data:/.test(e+="")?e:URL.fileURLToPath(new URL.URL(e,baseUrl));const s=new threads.Worker(__filename,{workerData:{mod:a,name:r,type:o}});Object.defineProperty(this,WORKER,{value:s}),s.on("message",(e=>{const t=new Event("message");t.data=e,this.dispatchEvent(t)})),s.on("error",(e=>{e.type="error",this.dispatchEvent(e)})),s.on("exit",(()=>{this.dispatchEvent(new Event("close"))}))}postMessage(e,t){this[WORKER].postMessage(e,t)}terminate(){this[WORKER].terminate()}}return e.prototype.onmessage=e.prototype.onerror=e.prototype.onclose=null,e}function workerThread(){let{mod,name,type}=threads.workerData;const self=global.self=global;let q=[];function flush(){const e=q;q=null,e.forEach((e=>{self.dispatchEvent(e)}))}threads.parentPort.on("message",(e=>{const t=new Event("message");t.data=e,null==q?self.dispatchEvent(t):q.push(t)})),threads.parentPort.on("error",(e=>{e.type="Error",self.dispatchEvent(e)}));class WorkerGlobalScope extends EventTarget{postMessage(e,t){threads.parentPort.postMessage(e,t)}close(){process.exit()}}let proto=Object.getPrototypeOf(global);delete proto.constructor,Object.defineProperties(WorkerGlobalScope.prototype,proto),proto=Object.setPrototypeOf(global,new WorkerGlobalScope),["postMessage","addEventListener","removeEventListener","dispatchEvent"].forEach((e=>{proto[e]=proto[e].bind(global)})),global.name=name;const isDataUrl=/^data:/.test(mod);if("module"===type)eval("import")(mod).catch((e=>{if(isDataUrl&&"Not supported"===e.message)return console.warn("Worker(): Importing data: URLs requires Node 12.10+. Falling back to classic worker."),evaluateDataUrl(mod,name);console.error(e)})).then(flush);else{try{/^data:/.test(mod)?evaluateDataUrl(mod,name):eval("require")(mod)}catch(e){console.error(e)}Promise.resolve().then(flush)}}function evaluateDataUrl(e,t){const{data:r}=parseDataUrl(e);return VM.runInThisContext(r,{filename:"worker.<"+(t||"data:")+">"})}function parseDataUrl(e){let[t,r,o,a]=e.match(/^data: *([^;,]*)(?: *; *([^,]*))? *,(.*)$/)||[];if(!t)throw Error("Invalid Data URL.");if(a=decodeURIComponent(a),o){if("base64"!==o.toLowerCase())throw Error('Unknown Data URL encoding "'+o+'"');a=Buffer.from(a,"base64").toString()}return{type:r,data:a}}},310:e=>{"use strict";e.exports=require("url")},144:e=>{"use strict";e.exports=require("vm")},267:e=>{"use strict";e.exports=require("worker_threads")}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](r,r.exports,__webpack_require__),r.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};return(()=>{"use strict";__webpack_require__.r(__webpack_exports__);var e=__webpack_require__(202),t=__webpack_require__.n(e);self.Worker=t()})(),__webpack_exports__})()}));
//# sourceMappingURL=zaplib_nodejs_polyfill.js.map